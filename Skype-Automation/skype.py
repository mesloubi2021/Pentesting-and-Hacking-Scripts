##################################################### Skype Automation ######################################################
################################################ Developed By Avdhesh Varshney ##############################################
############################################ (https://github.com/Avdhesh-Varshney) ##########################################

"""Install Python Packages as listed below using these commands in the terminal

Sr. No.         Package Name             Commands
1.              os                       pip install os
2.              skpy                     pip install SkPy

After install all these packages then import all of them in this file."""

# Importing libraries
import os
from skpy import Skype

os.system("cls" if os.name == "nt" else "clear")

# Global variables for username and password
print("\nWelcome to Skype Automation ü§ñ\n")
username = input("Enter your Skype username: ")
password = input("\nEnter your Skype password: ")
print("\n\n\tWait for some time for login...\n")

# Login into the skype account
try:
    slogin = Skype(username, password)

except:
    print("\nEither internet is not working or credentials are wrong !\n")
    exit(0)


# Fetching all chats of skype account
def allChats():
    chats = slogin.chats
    j = 1
    for i in chats:
        print(f"\n\n############ Chat-{j} ############\n")
        print(i)
        j = j + 1


# Fetching all contacts of skype account
def allContacts():
    contacts = slogin.contacts
    j = 1
    for i in contacts:
        print(f"\n\n############ Contact-{j} ############\n")
        print(i)
        j = j + 1


# Sending direct message to the any user
def sendMessage():
    message = input("Enter Your Message: ")
    to = input("\nEnter ID of Skype user: ")
    ch = slogin.contacts[to]
    ch.chat.sendMsg(message)

    print("\nMessage Delivered !\n")


# Create group on skype
def createGroup():
    arr = []
    j = 1
    n = int(input("Enter number of members of group: "))
    for i in range(n):
        id = input(f"\nEnter ID of user {j}: ")
        arr.append(id)
        j = j + 1

    # Create a group
    slogin.chats.create(arr)

    print("\nGroup Created !\n")


# Send a image to the user
def sendImage():
    to = input("Enter ID of Skype user: ")
    ch = slogin.contacts[to]
    path = input("\nEnter path of Image file: ")
    fileName = input("\nEnter Filename: ")
    with open(path, "rb") as f:
        ch.chat.sendFile(f, fileName, image=True)

    print("\nImage Shared !\n")


# Share any contact with the other user
def shareContact():
    to = input("Enter ID of Skype user: ")
    contact = []
    ct = input("\nContact of Whom: ")
    contact.append(ct)
    ch = slogin.contacts[to]
    ch.sendContact(slogin.contacts[contact])

    print("\nContact Shared !\n")


# Main function
def main():
    while True:
        # Get user's choice
        os.system("cls")
        print(
            """\n*********************** Welcome to Skype Automation ü§ñ ***********************\n
            \t\tEnter 1Ô∏è‚É£  to show user profile
            \t\tEnter 2Ô∏è‚É£  to enlist all the Contacts
            \t\tEnter 3Ô∏è‚É£  to enlist all the Chats
            \t\tEnter 4Ô∏è‚É£  to create a group
            \t\tEnter 5Ô∏è‚É£  to send a direct message to a user
            \t\tEnter 6Ô∏è‚É£  to send a image
            \t\tEnter 7Ô∏è‚É£  to share contact of any people
            \t\tEnter 0Ô∏è‚É£  to exit the program\n"""
        )

        try:
            value = int(input("Enter your choice: "))
        except ValueError:
            print("\nInvalid input! \n\nPlease enter a number from the options.")
            continue

        os.system("cls")
        print(
            "\n*********************** Welcome to Skype Automation ü§ñ ***********************\n"
        )

        if value == 0:
            os.system("cls")
            print(
                "\n******************* Thanks for using Skype Automation ü§ñ Program üëã *******************\n\n"
            )
            exit(0)

        elif value == 1:
            print("\nFetching Data from Internet...\n")
            print(slogin.user)

        elif value == 2:
            print("\nFetching Details of All Contacts...\n")
            allContacts()

        elif value == 3:
            print("\nFetching Details of All Chats...\n")
            allChats()

        elif value == 4:
            print("\nCreate a group with other users...\n")
            createGroup()

        elif value == 5:
            print("\nSending a direct message to a user...\n")
            sendMessage()

        elif value == 6:
            print("\nSending image directly to the user...\n")
            sendImage()

        elif value == 7:
            print("\nSharing contact of any user...\n")
            shareContact()

        else:
            print("\nInvalid choice. Please enter a valid number from the options.\n")

        input("\n\nPress 'Enter Key' to continue !\n\n")


# Driver function
if __name__ == "__main__":
    main()
